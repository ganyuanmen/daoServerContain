(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{414:function(a,s,r){"use strict";r.r(s);var t=r(55),e=Object(t.a)({},(function(){var a=this,s=a.$createElement,r=a._self._c||s;return r("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[r("h1",{attrs:{id:"网站部署"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#网站部署"}},[a._v("#")]),a._v(" 网站部署")]),a._v(" "),r("h2",{attrs:{id:"docker-部署"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#docker-部署"}},[a._v("#")]),a._v(" docker 部署")]),a._v(" "),r("p",[a._v("网站采用两个docker 容器部署， 一个是mysql 容器， 另一个是java 容器。mysql容器是用于主链数据的缓存，java 容器提供网站支侍。")]),a._v(" "),r("h6",{attrs:{id:"下载docker镜像"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#下载docker镜像"}},[a._v("#")]),a._v(" 下载docker镜像")]),a._v(" "),r("div",{staticClass:"language-js extra-class"},[r("pre",{pre:!0,attrs:{class:"language-js"}},[r("code",[a._v(" docker pull fhtcgym123"),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("dao_mysql\n docker pull fhtcgym123"),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("dao_server\n\n")])])]),r("h6",{attrs:{id:"安装部署"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#安装部署"}},[a._v("#")]),a._v(" 安装部署")]),a._v(" "),r("div",{staticClass:"language-js extra-class"},[r("pre",{pre:!0,attrs:{class:"language-js"}},[r("code",[a._v("docker run "),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("itd "),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),a._v("name dao_mysql  "),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("v "),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("mysql"),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("data"),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),r("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("var")]),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("lib"),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("mysql "),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("e "),r("span",{pre:!0,attrs:{class:"token constant"}},[a._v("MYSQL_ROOT_PASSWORD")]),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("Dao"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),r("span",{pre:!0,attrs:{class:"token number"}},[a._v(".123")]),a._v(" dao_mysql\ndocker run "),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("itd "),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("p "),r("span",{pre:!0,attrs:{class:"token number"}},[a._v("8086")]),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),r("span",{pre:!0,attrs:{class:"token number"}},[a._v("8088")]),a._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),a._v("name daoserver "),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),a._v("link dao_mysql"),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v("dao_mysql  dao_server\n\n")])])]),r("ul",[r("li",[a._v("mysql 数据库需要挂载在宿主机上，可以永久保存缓存数据。 -v /mysql/data:/var/lib/mysql 表示数据挂载在宿主机的 /mysql/data 目录下，可以根据实际更改挂载目录。")]),a._v(" "),r("li",[a._v("-e MYSQL_ROOT_PASSWORD=Dao..123 表示mysql root用户的密码是 Dao..123，不能更改，否则网站将连接不上数据库。这里的mysql 是运行在容器中， 不提供对外接口，只有用 --link参数 运行的容器才能访问，因此不存在数据安全问题。")]),a._v(" "),r("li",[a._v("--link dao_mysql:dao_mysql 是必须的， 表示网站的数据由dao_mysql容器提供。")]),a._v(" "),r("li",[a._v("-p 8086:8088 表示容器的接口映射到宿主机的端口上。 容器的8088端口提供网站的访问， 宿主机可以根据实际映射该端口。")])]),a._v(" "),r("h6",{attrs:{id:"mysql-dockerfile"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#mysql-dockerfile"}},[a._v("#")]),a._v(" mysql Dockerfile")]),a._v(" "),r("div",{staticClass:"language-html extra-class"},[r("pre",{pre:!0,attrs:{class:"language-html"}},[r("code",[a._v('\nFROM docker.io/mysql\n\n#指明该镜像的作者和电子邮箱\nMAINTAINER gym "393909065@qq.com"\n \nEXPOSE 3306\n\n#定义会被容器自动执行的目录\nENV AUTO_RUN_DIR /docker-entrypoint-initdb.d\n\n#定义初始化sql文件\nENV INIT_SQL admin.sql\n\n#把要执行的sql文件放到/docker-entrypoint-initdb.d/目录下，容器会自动执行这个sql\nCOPY admin.sql ./$INIT_SQL $AUTO_RUN_DIR/\n\n#给执行文件增加可执行权限\nRUN chmod a+x $AUTO_RUN_DIR/$INIT_SQL\n\n')])])]),r("h6",{attrs:{id:"java-网站-dockerfile"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#java-网站-dockerfile"}},[a._v("#")]),a._v(" java 网站 Dockerfile")]),a._v(" "),r("div",{staticClass:"language-html extra-class"},[r("pre",{pre:!0,attrs:{class:"language-html"}},[r("code",[a._v('\nFROM docker.io/java:8\n\n#指明该镜像的作者和电子邮箱\nMAINTAINER gym "393909065@qq.com"\n \n#在构建镜像时，指定镜像的工作目录，之后的命令都是基于此工作目录，如果不存在，则会创建目录\nWORKDIR /home\n \nCOPY daoserver-0.1.jar  /home\n\nEXPOSE 8088\n\nRUN chmod a+x /home/daoserver-0.1.jar\n\nENTRYPOINT ["java", "-jar","/home/daoserver-0.1.jar"]\n\n')])])])])}),[],!1,null,null,null);s.default=e.exports}}]);